# Pipeline for a Kubernetes application.
# This makes a progressive delivery with BlueGreen strategy.
apiVersion: pipecd.dev/v1beta1
kind: KubernetesApp
spec:
  pipeline:
    stages:
      - name: K8S_STAGE_ROLLOUT
        with:
          replicas: 100%
      - name: K8S_TRAFFIC_SPLIT
        with:
          stage: 100
      - name: K8S_PRIMARY_UPDATE
      - name: K8S_TRAFFIC_SPLIT
        with:
          primary: 100
      - name: K8S_STAGE_CLEAN
  trafficSplit:
    method: pod
